import Subject from"./subject.model.js";import{requireAuth}from"../../middleware/auth.js";const subjectResolvers={Query:{subjects:async(e,t,s)=>{try{const e=requireAuth(s),t=e?.school[0].id;return await Subject.find({school:t}).populate("school").sort({createdAt:-1})}catch(e){return{status:400,type:"error",message:e.message}}},getSubjectById:async(e,t)=>{try{const e=await Subject.findById(t.id).populate("school");return e||{status:400,type:"error",message:`Subject with ID ${t.id} not found`}}catch(e){return{status:400,type:"error",message:e.message}}},getSubjectsBySchool:async(e,t,s)=>{try{const e=requireAuth(s),t=e?.school[0].id;return await Subject.find({school:t}).sort({title:-1})}catch(e){return{status:400,type:"error",message:e.message}}}},Mutation:{addSubject:async(e,t,s)=>{try{const e=requireAuth(s),r=e?.school[0].id;t.data.school=r;const u=new Subject(t.data);return await u.save(),{status:200,type:"success",message:"Subject successfully added"}}catch(e){return{status:400,type:"error",message:e.message}}},updateSubject:async(e,t,s)=>{try{const e=requireAuth(s);e?.school[0].id;return await Subject.findByIdAndUpdate(t.id,t.data,{new:!0,runValidators:!0})?{status:200,type:"success",message:"Subject successfully updated"}:{status:400,type:"error",message:`Subject with ID ${t.id} not found`}}catch(e){return{status:400,type:"error",message:e.message}}},deleteSubject:async(e,t,s)=>{try{const e=requireAuth(s);e?.school[0].id;return await Subject.findByIdAndDelete(t.id)?{status:200,type:"success",message:"Subject successfully deleted"}:{status:400,type:"error",message:`Subject with ID ${t.id} not found`}}catch(e){return{status:400,type:"error",message:e.message}}},deleteMultipleSubjects:async(e,t)=>{try{return await Subject.deleteMany({_id:{$in:t.data}})?{status:200,type:"success",message:"Subjects successfully deleted"}:{status:400,type:"error",message:"Subjects not found"}}catch(e){return{status:400,type:"error",message:e.message}}}}};export default subjectResolvers;